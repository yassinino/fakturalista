import{e as D,r as p,A as I,o as r,c,b as s,t as e,i as P,w as C,d as m,F as M,C as B,j as S,x as f,z as T,n as N,l as A,E as H}from"./main-2e3c3264.js";const R={class:"content"},q={class:"content-heading"},G={class:"table-responsive"},J={class:"table table-borderless table-hover table-vcenter text-center mb-0"},K={class:"table-dark text-uppercase fs-sm"},O=s("th",{class:"py-3",style:{width:"180px"}},null,-1),Q={class:"py-3"},W={class:"py-3"},X={class:"py-3 bg-primary"},Y=s("i",{class:"fa fa-thumbs-up me-1"},null,-1),Z={class:"bg-body-light"},x=s("td",null,null,-1),ss={class:"py-4"},ts=s("div",{class:"h1 fw-bold mb-2"},"9 €",-1),es={class:"h6 text-muted mb-0"},os={class:"py-4"},ns=s("div",{class:"h1 fw-bold mb-2"},"19 €",-1),ls={class:"h6 text-muted mb-0"},is={class:"py-4"},as=s("div",{class:"h1 fw-bold text-primary mb-2"},"29 €",-1),rs={class:"h6 text-primary-light mb-0"},cs={class:"fw-semibold text-start"},us=s("td",null,"10",-1),ds=s("td",null,"100",-1),ps={class:"fw-semibold text-start"},bs=s("td",null,"3",-1),_s=s("td",null,"10",-1),hs={class:"fw-semibold text-start"},vs=s("td",null,"10",-1),ms=s("td",null,"100",-1),fs={class:"fw-semibold text-start"},ys={class:"fw-semibold text-start"},$s=s("td",null,[s("i",{class:"fa fa-check fa-fw text-success"})],-1),ks=s("td",null,[s("i",{class:"fa fa-check fa-fw text-success"})],-1),ws=s("td",null,[s("i",{class:"fa fa-check fa-fw text-success"})],-1),gs={class:"bg-body-light"},Ps=s("td",null,null,-1),Cs=["disabled","onClick"],Ms={key:0,class:"mt-4"},Bs={class:"mb-3"},Ss={class:"fw-bold"},Ns={class:"row g-3 content"},Es=["onClick"],Vs=["id","value"],Fs=["for"],Us={key:0,class:"col-12"},zs={class:"alert alert-danger mb-0"},Ls={class:"mb-3 mt-4 d-flex justify-content-between align-items-center"},js={class:"text-muted"},Ds=["disabled"],Is={key:0},Ts={key:1},As=s("i",{class:"fa fa-sync fa-spin me-1"},null,-1),qs={__name:"subscription",setup(Hs){const{t:u}=D(),y=p(!0),$=p(""),E=async()=>{$.value="";try{const{data:t}=await f.get("/plans");y.value=(t==null?void 0:t.plans)??[]}catch{$.value=u("subscription.errors.loadPlans")}finally{}},_=p(null),V=async()=>{try{const{data:t}=await f.get("/subscription");_.value=(t==null?void 0:t.subscription)??null}catch(t){console.error("No se pudo cargar la suscripción actual",t)}};I(()=>{E(),V()});const d=p(null),l=p(""),h=p(!1),a=p(""),F={Básico:"basic",Basico:"basic",Profesional:"professional",Empresa:"enterprise"},U=t=>{const n=F[t==null?void 0:t.name]??null;return n?u(`subscription.plans.${n}`):(t==null?void 0:t.name)??""},z=t=>{v(t)||(d.value=t,l.value="",a.value="")},v=t=>{var b,k,w,g;const n=["active","trialing"],i=((b=_.value)==null?void 0:b.status)??null;if(!i||!n.includes(String(i).toLowerCase()))return!1;const o=((k=_.value)==null?void 0:k.plan_id)??((g=(w=_.value)==null?void 0:w.plan)==null?void 0:g.id)??null;return!o&&t.status!="active"?!1:Number(o)===Number(t.id)},L=[{id:"paypal",label:"PayPal"},{id:"stripe",label:"Stripe"}],j=async()=>{var t,n;if(a.value="",!d.value){a.value=u("subscription.errors.selectPlan");return}if(!l.value){a.value=u("subscription.errors.selectPaymentMethod");return}if(l.value==="stripe")try{h.value=!0;const o=(await f.post("/subscription/checkout",{plan_id:d.value.id})).data.checkout_url;if(!o)throw new Error(u("subscription.errors.missingCheckoutUrl"));window.location.href=o}catch(i){console.error(i),a.value=((n=(t=i.response)==null?void 0:t.data)==null?void 0:n.message)||u("subscription.errors.stripeStart")}finally{h.value=!1}else l.value==="paypal"&&(a.value=u("subscription.errors.paypalSoon"))};return(t,n)=>{const i=T("BaseBlock");return r(),c("div",R,[s("h2",q,e(t.$t("subscription.title")),1),P(i,null,{content:C(()=>[s("div",G,[s("table",J,[s("thead",K,[s("tr",null,[O,s("th",Q,e(t.$t("subscription.plans.basic")),1),s("th",W,e(t.$t("subscription.plans.professional")),1),s("th",X,[Y,m(" "+e(t.$t("subscription.plans.enterprise")),1)])])]),s("tbody",null,[s("tr",Z,[x,s("td",ss,[ts,s("div",es,e(t.$t("subscription.perMonth")),1)]),s("td",os,[ns,s("div",ls,e(t.$t("subscription.perMonth")),1)]),s("td",is,[as,s("div",rs,e(t.$t("subscription.perMonth")),1)])]),s("tr",null,[s("td",cs,e(t.$t("subscription.features.invoices")),1),us,ds,s("td",null,e(t.$t("subscription.values.unlimitedFeminine")),1)]),s("tr",null,[s("td",ps,e(t.$t("subscription.features.teamUsers")),1),bs,_s,s("td",null,e(t.$t("subscription.values.unlimitedMasculine")),1)]),s("tr",null,[s("td",hs,e(t.$t("subscription.features.customers")),1),vs,ms,s("td",null,e(t.$t("subscription.values.unlimitedMasculine")),1)]),s("tr",null,[s("td",fs,e(t.$t("subscription.features.support")),1),s("td",null,e(t.$t("subscription.values.supportEmail")),1),s("td",null,e(t.$t("subscription.values.supportFull")),1),s("td",null,e(t.$t("subscription.values.supportPriority")),1)]),s("tr",null,[s("td",ys,e(t.$t("subscription.features.pdfCustomization")),1),$s,ks,ws]),s("tr",gs,[Ps,(r(!0),c(M,null,B(y.value,o=>(r(),c("td",{key:o.name},[s("button",{type:"button",class:N(["btn rounded-pill px-4",[v(o)?"btn-outline-secondary":"btn-secondary"]]),disabled:v(o),onClick:b=>z(o)},e(v(o)?t.$t("subscription.currentPlan"):t.$t("subscription.choosePlan")),11,Cs)]))),128))])])])])]),_:1}),d.value?(r(),c("div",Ms,[s("h4",Bs,[m(e(t.$t("subscription.selectedPlan"))+" ",1),s("span",Ss,e(U(d.value))+" ("+e(d.value.price)+") ",1)]),P(i,{title:t.$t("subscription.paymentMethodTitle")},{content:C(()=>[s("div",Ns,[(r(),c(M,null,B(L,o=>s("div",{class:"col-md-6",key:o.id},[s("div",{class:N(["form-check border rounded p-3 h-100",{"border-primary":l.value===o.id,"cursor-pointer":!0}]),role:"button",onClick:b=>l.value=o.id},[A(s("input",{class:"form-check-input",type:"radio",id:`pay-${o.id}`,name:"payment-method",value:o.id,"onUpdate:modelValue":n[0]||(n[0]=b=>l.value=b)},null,8,Vs),[[H,l.value]]),s("label",{class:"form-check-label ms-2",for:`pay-${o.id}`},e(o.label),9,Fs)],10,Es)])),64)),a.value?(r(),c("div",Us,[s("div",zs,e(a.value),1)])):S("",!0),s("div",Ls,[s("div",js,e(t.$t("subscription.paymentHint")),1),s("button",{type:"button",class:"btn btn-primary",disabled:!l.value||!d.value||h.value,onClick:j},[h.value?(r(),c("span",Ts,[As,m(" "+e(t.$t("subscription.processing")),1)])):(r(),c("span",Is,e(t.$t("subscription.continue")),1))],8,Ds)])])]),_:1},8,["title"])])):S("",!0)])}}};export{qs as default};
