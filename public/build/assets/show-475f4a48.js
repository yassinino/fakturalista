import{r as p,e as I,f as N,g as T,A as x,o as h,c as v,i as _,w as r,b as e,d as f,t as s,m as M,F as j,C as z,K as F,x as b,z as g,l as E,D as J,n as K,k,J as L}from"./main-84df2961.js";import{_ as R}from"./Pagination-c8e9d85d.js";const S={class:"content"},q={class:"block-options-item"},G={class:"row"},H={class:"col-md-6"},O={class:"mb-4"},Q={class:"mb-1"},W={class:"fs-sm text-muted"},X={class:"col-md-6"},Y={class:"mb-4"},Z={class:"mb-1"},ee={class:"fs-sm text-muted"},te={class:"col-md-6"},se={class:"mb-4"},oe={class:"mb-1"},ae={class:"fs-sm text-muted"},le={class:"col-md-6"},ne={class:"mb-4"},ce={class:"mb-1"},de={class:"fs-sm text-muted"},ie={class:"col-md-6"},re={class:"mb-4"},ue={class:"mb-1"},_e={class:"fs-sm text-muted"},me=e("div",{class:"block-options-item"},null,-1),pe={class:"table table-vcenter"},he={class:"text-center"},ve={class:"d-none d-sm-table-cell"},be={class:"d-none d-sm-table-cell"},fe={class:"d-none d-sm-table-cell"},ge={class:"d-none d-sm-table-cell"},ke={class:"d-none d-sm-table-cell"},$e={class:"d-none d-sm-table-cell"},we={class:"text-center",style:{width:"100px"}},ye={class:"text-center",scope:"row"},Ce=["onUpdate:modelValue"],Be={class:"d-none d-sm-table-cell"},Pe={class:"d-none d-sm-table-cell"},Ue={class:"d-none d-sm-table-cell"},De={class:"d-none d-sm-table-cell"},Ve={class:"d-none d-sm-table-cell"},Ae={class:"d-none d-sm-table-cell"},Ie={class:"text-center"},Ne={class:"dropdown dropstart push"},Te=e("button",{type:"button",class:"btn btn-outline-primary dropdown-toggle",id:"dropdown-dropleft-dark","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},[e("i",{class:"fa fa-fw fa-ellipsis-v"})],-1),xe={class:"dropdown-menu fs-sm","aria-labelledby":"dropdown-dropleft-dark"},Me=["onClick"],je=["onClick"],Je={__name:"show",setup(ze){const $=L({}),d=p([]),{t:w}=I(),a=N({current_page:1,last_page:1,per_page:10,total:0}),l=p({}),y=T(()=>{var c,u,o,i;if(((c=l.value)==null?void 0:c.type)==1)return((u=l.value)==null?void 0:u.name)??"";const t=((o=l.value)==null?void 0:o.first_name)??"",n=((i=l.value)==null?void 0:i.last_name)??"";return`${t} ${n}`.trim()}),C=F(),B=p(C.params.id);async function m(t=a.current_page,n=a.per_page){const{data:c}=await b.get("/customers/"+B.value,{params:{page:t,per_page:n}});d.value=c.invoices,a.current_page=c.meta.current_page,a.last_page=c.meta.last_page,a.per_page=c.meta.per_page??n,a.total=c.meta.total,l.value=c.customer}x(()=>m());function P(t){t<1||t>a.last_page||(a.current_page=t,m(t,a.per_page))}function U(t){a.per_page=t,a.current_page=1,m(1,t)}const D=t=>{confirm(w("invoices.confirmDelete"))&&b.delete("/invoices/"+t.uuid).then(n=>{d.value=d.value.filter(c=>c.uuid!==t.uuid)}).catch(n=>{console.error("There was an error deleting the invoice!",n)})},V=t=>{d.value=d.value.map(n=>(n.checked=t,n))};async function A(t){b.post("/invoices/print",t).then(n=>{$.success(n.data.message),window.open(n.data.pdf_url,"_blank")})}return(t,n)=>{const c=g("router-link"),u=g("BaseBlock");return h(),v("div",S,[_(u,{title:t.$t("customers.detailTitle",{name:M(y)})},{options:r(()=>[e("div",q,[_(c,{to:"/admin/customers/edit/"+l.value.uuid,class:"btn btn-primary"},{default:r(()=>[f(s(t.$t("common.edit")),1)]),_:1},8,["to"])])]),default:r(()=>[e("div",G,[e("div",H,[e("div",O,[e("h5",Q,s(t.$t("customers.fields.name")),1),e("p",W,s(l.value.type==1?l.value.name:l.value.first_name+" "+l.value.last_name),1)])]),e("div",X,[e("div",Y,[e("h5",Z,s(t.$t("customers.fields.email")),1),e("p",ee,s(l.value.email),1)])]),e("div",te,[e("div",se,[e("h5",oe,s(t.$t("customers.fields.phone")),1),e("p",ae,s(l.value.phone),1)])]),e("div",le,[e("div",ne,[e("h5",ce,s(t.$t("customers.fields.billingAddress")),1),e("p",de,s(l.value.address_billing),1)])]),e("div",ie,[e("div",re,[e("h5",ue,s(t.$t("customers.fields.nif")),1),e("p",_e,s(l.value.ice),1)])])])]),_:1},8,["title"]),_(u,{title:t.$t("customers.invoicesTitle")},{options:r(()=>[me]),default:r(()=>[e("table",pe,[e("thead",null,[e("tr",null,[e("th",he,[e("input",{type:"checkbox",class:"form-check-input",onChange:V},null,32)]),e("th",ve,s(t.$t("invoices.table.number")),1),e("th",be,s(t.$t("invoices.table.customer")),1),e("th",fe,s(t.$t("invoices.table.date")),1),e("th",ge,s(t.$t("invoices.table.subtotal")),1),e("th",ke,s(t.$t("invoices.table.total")),1),e("th",$e,s(t.$t("invoices.table.status")),1),e("th",we,s(t.$t("common.actions")),1)])]),e("tbody",null,[(h(!0),v(j,null,z(d.value,o=>(h(),v("tr",{key:o.id},[e("th",ye,[E(e("input",{type:"checkbox",name:"",class:"form-check-input","onUpdate:modelValue":i=>o.checked=i},null,8,Ce),[[J,o.checked]])]),e("td",Be,[_(c,{to:"invoices/edit/"+o.uuid},{default:r(()=>[f(s(o.reference),1)]),_:2},1032,["to"])]),e("td",Pe,s(o.customer),1),e("td",Ue,s(o.date),1),e("td",De,s(t.$toComma(o.sub_total)),1),e("td",Ve,s(t.$toComma(o.total)),1),e("td",Ae,[e("span",{class:K(["fs-xs fw-semibold d-inline-block py-1 px-3 rounded-pill",o.status==1?"bg-success-light text-success":"bg-danger-light text-danger"])},s(o.status==1?t.$t("invoices.statusPaid"):t.$t("invoices.statusUnpaid")),3)]),e("td",Ie,[e("div",Ne,[Te,e("div",xe,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:k(i=>A(o),["prevent"])},s(t.$t("invoices.document")),9,Me),e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:k(i=>D(o),["prevent"])},s(t.$t("common.delete")),9,je)])])])]))),128))])]),_(R,{data:d.value,meta:{currentPage:a.current_page,lastPage:a.last_page,perPage:a.per_page,total:a.total},"onUpdate:page":P,"onUpdate:perPage":U},null,8,["data","meta"])]),_:1},8,["title"])])}}};export{Je as default};
