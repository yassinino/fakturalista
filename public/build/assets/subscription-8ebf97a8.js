import{r as d,y as U,o as n,c,h as x,w as P,b as t,F as C,A as S,d as h,t as p,i as N,s as m,x as $,n as B,k as D,C as L}from"./main-eaddb9f9.js";const z={class:"content"},R=t("h2",{class:"content-heading"},"Elige un plan para seguir usando en Fakturalista",-1),T={class:"table-responsive"},j={class:"table table-borderless table-hover table-vcenter text-center mb-0"},q=t("thead",{class:"table-dark text-uppercase fs-sm"},[t("tr",null,[t("th",{class:"py-3",style:{width:"180px"}}),t("th",{class:"py-3"},"Básico"),t("th",{class:"py-3"},"Profesional"),t("th",{class:"py-3 bg-primary"},[t("i",{class:"fa fa-thumbs-up me-1"}),h(" Empresa ")])])],-1),A=t("tr",{class:"bg-body-light"},[t("td"),t("td",{class:"py-4"},[t("div",{class:"h1 fw-bold mb-2"},"9 €"),t("div",{class:"h6 text-muted mb-0"},"por mes")]),t("td",{class:"py-4"},[t("div",{class:"h1 fw-bold mb-2"},"19 €"),t("div",{class:"h6 text-muted mb-0"},"por mes")]),t("td",{class:"py-4"},[t("div",{class:"h1 fw-bold text-primary mb-2"},"29 €"),t("div",{class:"h6 text-primary-light mb-0"},"por mes")])],-1),H=t("tr",null,[t("td",{class:"fw-semibold text-start"},"Facturas"),t("td",null,"10"),t("td",null,"100"),t("td",null,"Ilimitadas")],-1),G=t("tr",null,[t("td",{class:"fw-semibold text-start"},"Usuarios del equipo"),t("td",null,"3"),t("td",null,"10"),t("td",null,"Ilimitados")],-1),J=t("tr",null,[t("td",{class:"fw-semibold text-start"},"Clientes"),t("td",null,"10"),t("td",null,"100"),t("td",null,"Ilimitados")],-1),K=t("tr",null,[t("td",{class:"fw-semibold text-start"},"Soporte"),t("td",null,"Email"),t("td",null,"Completo"),t("td",null,"Prioritario")],-1),O=t("tr",null,[t("td",{class:"fw-semibold text-start"},"Personalización de template PDF"),t("td",null,[t("i",{class:"fa fa-check fa-fw text-success"})]),t("td",null,[t("i",{class:"fa fa-check fa-fw text-success"})]),t("td",null,[t("i",{class:"fa fa-check fa-fw text-success"})])],-1),Q={class:"bg-body-light"},W=t("td",null,null,-1),X=["disabled","onClick"],Y={key:0,class:"mt-4"},Z={class:"mb-3"},tt={class:"fw-bold"},et={class:"row g-3 content"},st=["onClick"],at=["id","value"],lt=["for"],ot={key:0,class:"col-12"},nt={class:"alert alert-danger mb-0"},ct={class:"mb-3 mt-4 d-flex justify-content-between align-items-center"},it=t("div",{class:"text-muted"}," Selecciona PayPal o Stripe y continúa. ",-1),rt=["disabled"],dt={key:0},ut={key:1},pt=t("i",{class:"fa fa-sync fa-spin me-1"},null,-1),vt={__name:"subscription",setup(_t){const f=d(!0),y=d(""),E=async()=>{y.value="";try{const{data:e}=await m.get("/plans");f.value=(e==null?void 0:e.plans)??[]}catch{y.value="No se pudieron cargar planes."}finally{}},_=d(null),F=async()=>{try{const{data:e}=await m.get("/subscription");_.value=(e==null?void 0:e.subscription)??null}catch(e){console.error("No se pudo cargar la suscripción actual",e)}};U(()=>{E(),F()});const i=d(null),a=d(""),b=d(!1),o=d(""),M=e=>{v(e)||(i.value=e,a.value="",o.value="")},v=e=>{var u,g,k,w;const r=["active","trialing"],l=((u=_.value)==null?void 0:u.status)??null;if(!l||!r.includes(String(l).toLowerCase()))return!1;const s=((g=_.value)==null?void 0:g.plan_id)??((w=(k=_.value)==null?void 0:k.plan)==null?void 0:w.id)??null;return!s&&e.status!="active"?!1:Number(s)===Number(e.id)},V=[{id:"paypal",label:"PayPal"},{id:"stripe",label:"Stripe"}],I=async()=>{var e,r;if(o.value="",!i.value){o.value="Por favor, selecciona un plan.";return}if(!a.value){o.value="Por favor, selecciona un método de pago.";return}if(a.value==="stripe")try{b.value=!0;const s=(await m.post("/subscription/checkout",{plan_id:i.value.id})).data.checkout_url;if(!s)throw new Error("No se ha recibido la URL de pago.");window.location.href=s}catch(l){console.error(l),o.value=((r=(e=l.response)==null?void 0:e.data)==null?void 0:r.message)||"Ha ocurrido un error al iniciar el pago con Stripe."}finally{b.value=!1}else a.value==="paypal"&&(o.value="El pago con PayPal estará disponible próximamente.")};return(e,r)=>{const l=$("BaseBlock");return n(),c("div",z,[R,x(l,null,{content:P(()=>[t("div",T,[t("table",j,[q,t("tbody",null,[A,H,G,J,K,O,t("tr",Q,[W,(n(!0),c(C,null,S(f.value,s=>(n(),c("td",{key:s.name},[t("button",{type:"button",class:B(["btn rounded-pill px-4",[v(s)?"btn-outline-secondary":"btn-secondary"]]),disabled:v(s),onClick:u=>M(s)},p(v(s)?"Tu plan actual":"Elegir este plan"),11,X)]))),128))])])])])]),_:1}),i.value?(n(),c("div",Y,[t("h4",Z,[h(" Plan seleccionado: "),t("span",tt,p(i.value.name)+" ("+p(i.value.price)+") ",1)]),x(l,{title:"Método de pago"},{content:P(()=>[t("div",et,[(n(),c(C,null,S(V,s=>t("div",{class:"col-md-6",key:s.id},[t("div",{class:B(["form-check border rounded p-3 h-100",{"border-primary":a.value===s.id,"cursor-pointer":!0}]),role:"button",onClick:u=>a.value=s.id},[D(t("input",{class:"form-check-input",type:"radio",id:`pay-${s.id}`,name:"payment-method",value:s.id,"onUpdate:modelValue":r[0]||(r[0]=u=>a.value=u)},null,8,at),[[L,a.value]]),t("label",{class:"form-check-label ms-2",for:`pay-${s.id}`},p(s.label),9,lt)],10,st)])),64)),o.value?(n(),c("div",ot,[t("div",nt,p(o.value),1)])):N("",!0),t("div",ct,[it,t("button",{type:"button",class:"btn btn-primary",disabled:!a.value||!i.value||b.value,onClick:I},[b.value?(n(),c("span",ut,[pt,h(" Procesando... ")])):(n(),c("span",dt,"Continuar"))],8,rt)])])]),_:1})])):N("",!0)])}}};export{vt as default};
