import{r as m,e as P,y as A,o as d,c,h as N,w as V,b as e,k as w,v as h,n as y,t as g,i as _,d as B,j as S,s as C,x as D,H as F}from"./main-e01f9188.js";const j={class:"content content-boxed"},L=["onSubmit"],M={class:"row push"},T=e("div",{class:"col-lg-4"},[e("p",{class:"fs-sm text-muted"}," Actualiza tus datos de acceso y la imagen de tu cuenta. ")],-1),G={class:"col-lg-8 col-xl-5"},I={class:"mb-4"},R=e("label",{class:"form-label",for:"one-profile-edit-name"},"Nombre",-1),H=["disabled"],O={key:0,class:"invalid-feedback"},q={class:"mb-4"},J=e("label",{class:"form-label",for:"one-profile-edit-email"},"Correo electrónico",-1),K=["disabled"],Q={key:0,class:"invalid-feedback"},W={class:"mb-4"},X=e("label",{class:"form-label"},"Imagen de perfil",-1),Y={class:"mb-4"},Z=["src"],$={class:"mb-4"},ee=e("label",{for:"one-profile-edit-avatar",class:"form-label"},"Elige un nuevo imagen",-1),se=["disabled"],ae={class:"mb-4"},oe=["disabled"],te={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},re=["onSubmit"],le={class:"row push"},ie=e("div",{class:"col-lg-4"},[e("p",{class:"fs-sm text-muted"}," Cambiar tu contraseña de inicio de sesión es una forma fácil de mantener tu cuenta segura. ")],-1),ne={class:"col-lg-8 col-xl-5"},de={class:"mb-4"},ce=e("label",{class:"form-label",for:"one-profile-edit-password"},"Contraseña actual",-1),ue=["disabled"],pe={key:0,class:"invalid-feedback"},me={class:"row mb-4"},_e={class:"col-12"},ve=e("label",{class:"form-label",for:"one-profile-edit-password-new"},"Nueva contraseña",-1),fe=["disabled"],be={key:0,class:"invalid-feedback"},we={class:"row mb-4"},he={class:"col-12"},ye=e("label",{class:"form-label",for:"one-profile-edit-password-new-confirm"},"Confirmar nueva contraseña",-1),ge=["disabled"],ke={key:0,class:"invalid-feedback"},xe={class:"mb-4"},Ce=["disabled"],Pe={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},Se={__name:"profile",setup(Ne){const v=F({}),x="/assets/media/avatars/avatar13.jpg",f=m(x),k=m(null),n=P({name:"",email:""}),t=P({current_password:"",password:"",password_confirmation:""}),i=m({}),r=m({}),u=m(!1),p=m(!1),b=m(!0);A(async()=>{var l,a,o;b.value=!0,i.value={};try{const{data:s}=await C.get("/user");n.name=((l=s==null?void 0:s.user)==null?void 0:l.name)??"",n.email=((a=s==null?void 0:s.user)==null?void 0:a.email)??"",(o=s==null?void 0:s.user)!=null&&o.avatar_url?f.value=s.user.avatar_url:k.value||(f.value=x)}catch{v.error("No se pudo cargar tu perfil.")}finally{b.value=!1}});const U=l=>{const[a]=l.target.files||[];k.value=a||null,a?f.value=URL.createObjectURL(a):f.value=x},z=async()=>{var l,a;u.value=!0,i.value={};try{const o=new FormData;o.append("_method","put"),o.append("name",n.name??""),o.append("email",n.email??""),k.value&&o.append("avatar",k.value);const{data:s}=await C.post("/user",o,{headers:{"Content-Type":"multipart/form-data"}});v.success((s==null?void 0:s.message)??"Perfil actualizado correctamente.")}catch(o){if(((l=o.response)==null?void 0:l.status)===422){i.value=((a=o.response.data)==null?void 0:a.errors)||{};return}v.error("No se pudo actualizar el perfil.")}finally{u.value=!1}},E=async()=>{var l,a;p.value=!0,r.value={};try{const{data:o}=await C.post("/user",{_method:"put",current_password:t.current_password,password:t.password,password_confirmation:t.password_confirmation});v.success((o==null?void 0:o.message)??"Contraseña actualizada correctamente."),t.current_password="",t.password="",t.password_confirmation=""}catch(o){if(((l=o.response)==null?void 0:l.status)===422){r.value=((a=o.response.data)==null?void 0:a.errors)||{};return}v.error("No se pudo actualizar la contraseña.")}finally{p.value=!1}};return(l,a)=>{const o=D("BaseBlock");return d(),c("div",j,[N(o,{title:"Perfil de usuario"},{default:V(()=>[e("form",{onSubmit:S(z,["prevent"])},[e("div",M,[T,e("div",G,[e("div",I,[R,w(e("input",{type:"text",class:y(["form-control",{"is-invalid":i.value.name}]),id:"one-profile-edit-name",name:"one-profile-edit-name",placeholder:"Introduce tu nombre..","onUpdate:modelValue":a[0]||(a[0]=s=>n.name=s),disabled:b.value||u.value},null,10,H),[[h,n.name]]),i.value.name?(d(),c("div",O,g(i.value.name[0]),1)):_("",!0)]),e("div",q,[J,w(e("input",{type:"email",class:y(["form-control",{"is-invalid":i.value.email}]),id:"one-profile-edit-email",name:"one-profile-edit-email",placeholder:"Enter your email..","onUpdate:modelValue":a[1]||(a[1]=s=>n.email=s),disabled:b.value||u.value},null,10,K),[[h,n.email]]),i.value.email?(d(),c("div",Q,g(i.value.email[0]),1)):_("",!0)]),e("div",W,[X,e("div",Y,[e("img",{class:"img-avatar",src:f.value,alt:""},null,8,Z)]),e("div",$,[ee,e("input",{class:"form-control",type:"file",id:"one-profile-edit-avatar",accept:"image/*",onChange:U,disabled:u.value},null,40,se)])]),e("div",ae,[e("button",{type:"submit",class:"btn btn-alt-primary",disabled:u.value||b.value},[u.value?(d(),c("span",te)):_("",!0),B(" Guardar ")],8,oe)])])])],40,L)]),_:1}),N(o,{title:"Cambiar contraseña"},{default:V(()=>[e("form",{onSubmit:S(E,["prevent"])},[e("div",le,[ie,e("div",ne,[e("div",de,[ce,w(e("input",{type:"password",class:y(["form-control",{"is-invalid":r.value.current_password}]),id:"one-profile-edit-password",name:"one-profile-edit-password","onUpdate:modelValue":a[2]||(a[2]=s=>t.current_password=s),disabled:p.value},null,10,ue),[[h,t.current_password]]),r.value.current_password?(d(),c("div",pe,g(r.value.current_password[0]),1)):_("",!0)]),e("div",me,[e("div",_e,[ve,w(e("input",{type:"password",class:y(["form-control",{"is-invalid":r.value.password}]),id:"one-profile-edit-password-new",name:"one-profile-edit-password-new","onUpdate:modelValue":a[3]||(a[3]=s=>t.password=s),disabled:p.value},null,10,fe),[[h,t.password]]),r.value.password?(d(),c("div",be,g(r.value.password[0]),1)):_("",!0)])]),e("div",we,[e("div",he,[ye,w(e("input",{type:"password",class:y(["form-control",{"is-invalid":r.value.password_confirmation}]),id:"one-profile-edit-password-new-confirm",name:"one-profile-edit-password-new-confirm","onUpdate:modelValue":a[4]||(a[4]=s=>t.password_confirmation=s),disabled:p.value},null,10,ge),[[h,t.password_confirmation]]),r.value.password_confirmation?(d(),c("div",ke,g(r.value.password_confirmation[0]),1)):_("",!0)])]),e("div",xe,[e("button",{type:"submit",class:"btn btn-alt-primary",disabled:p.value},[p.value?(d(),c("span",Pe)):_("",!0),B(" Guardar ")],8,Ce)])])])],40,re)]),_:1})])}}};export{Se as default};
